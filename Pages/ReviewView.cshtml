@page "{id:int}"
@model MoonriseMovies.Pages.ReviewViewModel
@{
    ViewData["Title"] = "Review View";
}
<asp:ScriptManager ID="asm" runat="server" /> <!--runat calls the server and can communicate with our backend and control the elements value and then some-->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
<div class="main">
    <div class="container">
        <br>
        <div class="row">
            <div class="col-8">
                <h5>Add rating and review:</h5>
                <br><br>
                <div class="row">
                    <div class="col-md-4">
                        <form method="post">
                            <div class="form-group">
                                <i class="bi bi-star-fill"></i>
                                    <input asp-for="Rating" type="range" min="1" max="5">
                                    <span asp-validation-for="Rating" style="color:red; font-size:14px;"></span>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                            </div>
                            <br>
                            <div class="form-group">
                                <label asp-for="Comment" class="control-label"></label>
                                <textarea asp-for="Comment" class="form-control"></textarea>
                                <span asp-validation-for="Comment" style="color:red; font-size:14px;"></span>
                            </div>
                            <br>

                            <div class="form-group">
                                <input type="submit" value="Add Review" class="btn btn-secondary" /><br><br>
                                <a asp-page="/Index">Back to home page</a>
                            </div>
                        </form>
                    </div>
                </div>
                <br><br>
                @if(Model.reviewList.Count == 0){
                    <h4>No reviews yet! Purchase a ticket and be the first to leave a comment!</h4>
                }
                @*Here will be list of all comments*@
                @foreach (var r in Model.reviewList)
                {
                    @r.CreatedAt;<span>&nbsp; &nbsp;</span>@r.Client.UserName;<br>
                    <span>
                        @if (!@r.Rating.Equals(null))
                        {
                            int fullStars = @r.Rating;
                            int emptyStars = 5 - fullStars;
                            if (fullStars == 0)
                            {
                                <i class="bi bi-star"></i>
                                <i class="bi bi-star"></i>
                                <i class="bi bi-star"></i>
                                <i class="bi bi-star"></i>
                                <i class="bi bi-star"></i>
                            }
                            else
                            {
                                for (int i = 0; i < fullStars; i++)
                                {
                                    <i class="bi bi-star-fill"></i>
                                }
                                for (int j = 0; j < emptyStars; j++)
                                {
                                    <i class="bi bi-star"></i>
                                }
                            }
                        }
                    </span>
                    <br><br>
                    @r.Comment;
                    <hr>
                }
            </div>
            <div class="col-4">
                <br>
                <img src=@ViewData["Image"+Model.movie.Id.ToString()] class="img-fluid rounded-start" alt="...">
                <p>Title: @Model.movie.Title<br>Genre: @Model.movie.Genre<br>Duration: @Model.movie.DurationMin min<br>
                    <!--Call method for ratings-->
                    <span>
                        @if (!Model.movie.RatingAvg.Equals(null))
                        {
                            int fullStars = Decimal.ToInt32(Model.movie.RatingAvg);
                            int emptyStars = 5 - fullStars;
                            if (fullStars == 0)
                            {
                                <i class="bi bi-star"></i>
                                <i class="bi bi-star"></i>
                                <i class="bi bi-star"></i>
                                <i class="bi bi-star"></i>
                                <i class="bi bi-star"></i>
                            }
                            else
                            {
                                for (int i = 0; i < fullStars; i++)
                                {
                                    <i class="bi bi-star-fill"></i>
                                }
                                for (int j = 0; j < emptyStars; j++)
                                {
                                    <i class="bi bi-star"></i>
                                }
                            }
                        }
                    </span>
                    <!---->
                </p>
            </div>
        </div>
        <br>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}